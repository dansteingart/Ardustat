// Generated by CoffeeScript 1.6.2
var browserChannel, sessionHandler, wrapSession;

browserChannel = require('browserchannel').server;

sessionHandler = require('./session').handler;

wrapSession = function(session) {
  session.ready = function() {
    return this.state !== 'closed';
  };
  return session;
};

exports.attach = function(server, createAgent, options) {
  options.server = server;
  return server.use(browserChannel(options, function(session) {
    return sessionHandler(wrapSession(session), createAgent);
  }));
};
